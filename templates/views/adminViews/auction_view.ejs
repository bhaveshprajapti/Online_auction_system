<!DOCTYPE html>
<html lang="en" dir="ltr">



<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">

    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">


    <meta name="description" content="Global Auction System">
    <meta name="keywords" content="Global Auction System">
    <meta name="csrf_token" content="Zw1eYq4tsFJFwBA8kJfLb6fP8Lt3xu69dsUILDfj">

    <link rel="icon" href="/public/uploads/settings/H0DUiWpMJYMGEPP.png" type="image/x-icon" />

    <title>Bidzone - Online auction and bidding</title>



    <link href="/public/css/dropzone/basic.css" rel="stylesheet">

    <script src="/public/js/dropzone.js"></script>
    <link href="/public/adminlte/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/public/adminlte/css/select2.min.css" />
    <link href="/public/adminlte/css/AdminLTE.min.css" rel="stylesheet">
    <link href="/public/adminlte/css/custom.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/public/css/global-admin.css" rel="stylesheet">

    <!-- <link href="/public/adminlte/css/skins/skin-blue.min.css" rel="stylesheet"> -->

    <link href="/public/css/sweetalert.css" rel="stylesheet" type="text/css">






    <link rel="stylesheet" href="/public/adminlte/css/online/jquery-ui.css">
    <link rel="stylesheet" href="/public/adminlte/css/online/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="/public/adminlte/css/online/select.dataTables.min.css" />
    <link rel="stylesheet" href="/public/adminlte/css/online/buttons.dataTables.min.css" />
    <link rel="stylesheet" href="/public/adminlte/css/online/jquery-ui-timepicker-addon.min.css" />
    <link rel="stylesheet" href="/public/adminlte/css/online/bootstrap-datepicker.standalone.min.css" />



    <!-- Font Awesome -->
    <link rel="stylesheet" href="/public/adminlte/css/online/font-awesome.min.css">


    <!-- Ionicons -->
    <link rel="stylesheet" href="/public/adminlte/css/online/ionicons.min.css">

    <link href="/public/css/admin.css" rel="stylesheet">


    <!--admin custom css-->
    <link href="/public/css/admin-custom.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>




<body class="hold-transition skin-blue sidebar-mini" ng-app="academia">

    <div ng-controller="prepareAuctionData">


        <div id="wrapper">

            <%- include ('admin_side_navbar')%>
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                <!-- Main content -->
                <section class="content">

                    <div class="row">
                        <div class="col-md-12">




                            <h3 class="page-title"> Auctions </h3>

                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    View
                                </div>



                                <div class="panel-body">


                                    <!-- Nav tabs -->
                                    <ul class="nav nav-tabs nav-justified">
                                        <li class="nav-item">
                                            <a class="nav-link active" data-toggle="tab" href="#panel1" role="tab"><i class="fa fa-list"></i> Auction Details </a>
                                        </li>
                                            <!-- <li class="nav-item">
                                                <a class="nav-link" data-toggle="tab" href="#panel2" role="tab"><i class="far fa-image"></i> Images </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" data-toggle="tab" href="#panel3" role="tab"><i class="fa fa-user"></i> Auction Bidders </a>
                                            </li> -->
                                    </ul>




                                    <!-- Tab panels -->
                                    <div class="tab-content">


                                        <!--Panel 1-->
                                        <div class="tab-pane fade in active" id="panel1" role="tabpanel">

                                            <br>
                                            <div class="row">

                                                <div class="col-md-12">

                                                    <div class="table-responsive">

                                                        
                                                        <table class="table table-bordered table-striped">
                                                            <% Object.entries(product).forEach(([key, value]) => { %>
                                                                <% if (key !== 'image' && key !== 'lastUpdatedBy') { %>
                                                                    <tr>
                                                                        <th> <%= key %> </th>
                                                                        <td><%= value %></td>
                                                                    </tr>
                                                                <% } %>
                                                            <% }); %>
                                                        
                                                            <!-- Display bid details -->
                                                            <% bids.forEach(bid => { %>
                                                                <tr>
                                                                    <th> Bid Amount </th>
                                                                    <td><%= bid.amount %></td>
                                                                </tr>
                                                                <tr>
                                                                    <th> Created At </th>
                                                                    <td><%= bid.createdAt %></td>
                                                                </tr>
                                                                <!-- You can include more bid details here -->
                                                            <% }); %>
                                                        
                                                            <!-- Display image at the end -->
                                                            <% Object.entries(product).forEach(([key, value]) => { %>
                                                                <% if (key === 'image') { %>
                                                                    <tr>
                                                                        <th> <%= key %> </th>
                                                                        <td>
                                                                            <% if (value !== 'no_image') { %>
                                                                                <img src="<%= value %>" alt="Product Image" style="width: 200px;">
                                                                            <% } else { %>
                                                                                <%= value %>
                                                                            <% } %>
                                                                        </td>
                                                                    </tr>
                                                                <% } %>
                                                            <% }); %>
                                                        </table>
                                                        
                                                        
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--/.Panel 1-->







                                        <!--Panel 2-->
                                        <div class="tab-pane fade" id="panel2" role="tabpanel">

                                            <br>
                                            <div class="row">

                                                <div class="col-md-12">
                                                    <h4>Upload Images</h4>

                                                    <form method="POST" action="/auctions/upload-images/wrqwr-527ef85a26d131d4ee1e353c1b37fa5edecb9c9a-96" accept-charset="UTF-8" novalidate="" name="formUsers" class="dropzone" id="real-dropzone" multiple enctype="multipart/form-data"><input name="_token" type="hidden" value="Zw1eYq4tsFJFwBA8kJfLb6fP8Lt3xu69dsUILDfj">

                                                        <div class="row">

                                                            <div class="col-lg-4">
                                                                <div class="dragble-area">
                                                                    <div class="dz-message">
                                                                        <h4 style="text-align: center;color:#428bca;">Drop files in this area <span class="glyphicon glyphicon-hand-down"></span></h4>
                                                                    </div>
                                                                </div>

                                                                <div class="instuctions-block mt-3">
                                                                    <ul>
                                                                        <li>Only Image Files Are Accepted</li>
                                                                        <li>Files Are Uploaded As Soon As You Drop Them</li>
                                                                        <li>Maximum Allowed Size Is 5mb</li>
                                                                        <li style="color:red;">For Good Resolution Image Width Height 950x650</li>
                                                                    </ul>

                                                                </div>

                                                            </div>

                                                            <div class="col-sm-6">
                                                                <div class="scroll-height">
                                                                    <h3 class="files-title">Total Uploaded Files <span id="photoCounter"></span></h3>
                                                                    <div class="dropzone-previews" id="dropzonePreview"></div>
                                                                </div>
                                                            </div>

                                                        </div>


                                                        <div class="fallback">
                                                            <input type="file" name="file" multiple />
                                                        </div>


                                                    </form>

                                                </div>

                                            </div>


                                            <!-- Dropzone Preview Template -->
                                            <div id="preview-template" style="display: none;">

                                                <div class="dz-preview dz-file-preview">
                                                    <div class="dz-image pdf-overlay"> <img data-dz-thumbnail=""> </div>

                                                    <div class="dz-details">
                                                        <div class="dz-size"><span data-dz-size=""></span></div>
                                                        <div class="dz-filename"><span data-dz-name=""></span></div>
                                                    </div>

                                                    <div class="dz-error-message"><span data-dz-errormessage=""></span></div>

                                                    <div class="dz-success-mark">
                                                        <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                    <!-- Generator: Sketch 3.2.1 (9971) - http://www.bohemiancoding.com/sketch -->
                    <title>Check</title>
                    <desc>Created with Sketch.</desc>
                    <defs></defs>
                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
                    </g>
                </svg>
                                                    </div>

                                                    <div class="dz-error-mark">
                                                        <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                    <!-- Generator: Sketch 3.2.1 (9971) - http://www.bohemiancoding.com/sketch -->
                    <title>error</title>
                    <desc>Created with Sketch.</desc>
                    <defs></defs>
                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">
                            <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>
                        </g>
                    </g>
                </svg>
                                                    </div>

                                                </div>
                                            </div>
                                            <!-- End Dropzone Preview Template -->

                                        </div>
                                        <!--/.Panel 2-->









                                        <!--Panel 3-->
                                        <div class="tab-pane fade" id="panel3" role="tabpanel">
                                            <br>
                                            <div class="row">

                                                <div class="col-md-12">

                                                    <div class="table-responsive">

                                                        <table class="table table-bordered table-striped datatable">

                                                            <thead>

                                                                <tr>
                                                                    <th>#</th>
                                                                    <th> Username </th>
                                                                    <th> Email </th>
                                                                    <th> Image </th>
                                                                    <th> No Of Times </th>
                                                                    <th> Highest Bid </th>


                                                                    <th>&nbsp;</th>

                                                                </tr>
                                                            </thead>
                                                        </table>


                                                    </div>

                                                </div>

                                            </div>


                                        </div>
                                        <!--/.Panel 3-->

                                    </div>


                                    <p>&nbsp;</p>

                                    <a href="/admin/auctions" class="btn btn-default"> Back To List </a>
                                    <a href="/admin/update-auction/<%= product.id%>" class="btn btn-default"> Edit </a>
                                </div>







                                <!-- Bid history Modal -->
                                <div class="modal fade right" id="bidHistoryModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-full-height modal-right" role="document">


                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Bid History</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
                                            </div>

                                            <div class="modal-body">


                                                <ul class="list-group z-depth-0">

                                                    <li class="list-group-item justify-content-between">
                                                        <span><b>Bid Amount</b></span>
                                                        <span style="float:right;"><b>Datetime</b></span>
                                                    </li>

                                                    <li ng-repeat="bid in bid_history" class="list-group-item justify-content-between">
                                                        <span>INR{{bid.bid_amount}}</span>
                                                        <span style="float:right;">{{bid.created_at}}</span>
                                                    </li>
                                                </ul>

                                            </div>

                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--Bid history modal end-->






                                <!--send Email modal-->
                                <div class="modal fade" id="sendEmailModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Send Invoice Email To Bidder Regarding Payment</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
                                            </div>



                                            <div class="modal-body form-auth-style">

                                                <form method="POST" action="/auctions/send-email-bid" accept-charset="UTF-8" name="formValidate" novalidate=""><input name="_token" type="hidden" value="Zw1eYq4tsFJFwBA8kJfLb6fP8Lt3xu69dsUILDfj">

                                                    <input type="hidden" name="ab_id" id="ab_id" value="">
                                                    <input type="hidden" name="auction_id" value="98">

                                                    <p>Send Email notification to User regarding payment of Auction</p>

                                                    <div class="form-group">

                                                        <textarea class="form-control ckeditor" placeholder="Enter Email Content/Message to Bidder" ng-model="message" required="true" rows="3" ng-class="{&quot;has-error&quot;: formValidate.message.$touched &amp;&amp; formValidate.message.$invalid}" name="message"
                                                            cols="50"></textarea>

                                                        <div class="validation-error" ng-messages="formValidate.message.$error">

                                                            <p ng-message="required">This Field Is Required</p>

                                                        </div>

                                                    </div>

                                                    <div class="form-group">

                                                        <label for="sent_at" class="control-label">Start Date</label>

                                                        <span class="text-red">*</span>

                                                        <input class="form-control" id="datetimepicker6" placeholder="Payment Start Date and Time" ng-model="sent_at" name="sent_at" type="text">


                                                    </div>


                                                    <div class="form-group">

                                                        <label for="end_date" class="control-label">End Date</label>

                                                        <span class="text-red">*</span>



                                                        <input class="form-control" id="datetimepicker7" placeholder="Payment End Date and Time" ng-model="ended_at" name="ended_at" type="text">


                                                    </div>



                                                    <div class="modal-footer">

                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                                                        <button type="submit" name="send_email" class="btn btn-primary" ng-disabled="!formValidate.$valid">Send</button>

                                                    </div>



                                                </form>



                                            </div>







                                        </div>
                                    </div>
                                </div>
                                <!--send Email modal-->





                            </div>

                        </div>
                    </div>
                </section>
            </div>
            </div>

            <form method="POST" action="/logout" accept-charset="UTF-8" style="display:none;" id="logout"><input name="_token" type="hidden" value="Zw1eYq4tsFJFwBA8kJfLb6fP8Lt3xu69dsUILDfj">
                <button type="submit">Logout</button>
            </form>

            <script>
                window.deleteButtonTrans = 'Delete selected';
                window.copyButtonTrans = 'Copy';
                window.csvButtonTrans = 'CSV';
                window.excelButtonTrans = 'Excel';
                window.pdfButtonTrans = 'PDF';
                window.printButtonTrans = 'Print';
                window.colvisButtonTrans = 'Column visibility';
            </script>


            <script src="/public/adminlte/js/online/jquery-1.11.3.min.js"></script>
            <script src="/public/adminlte/js/online/jquery.dataTables.min.js"></script>
            <script src="/public/adminlte/js/online/dataTables.buttons.min.js"></script>
            <script src="/public/adminlte/js/online/buttons.flash.min.js"></script>
            <script src="/public/adminlte/js/online/jszip.min.js"></script>


            <script src="/public/adminlte/js/online/pdfmake.min.js"></script>
            <script src="/public/adminlte/js/online/vfs_fonts.js"></script>
            <script src="/public/adminlte/js/online/buttons.html5.min.js"></script>
            <script src="/public/adminlte/js/online/buttons.print.min.js"></script>
            <script src="/public/adminlte/js/online/buttons.colVis.min.js"></script>
            <script src="/public/adminlte/js/online/dataTables.select.min.js"></script>
            <script src="/public/adminlte/js/online/jquery-ui.min.js"></script>



            <script src="/public/adminlte/js/bootstrap.min.js"></script>
            <script src="/public/adminlte/js/select2.full.min.js"></script>
            <script src="/public/adminlte/js/main.js"></script>

            <script src="/public/adminlte/plugins/slimScroll/jquery.slimscroll.min.js"></script>
            <script src="/public/adminlte/plugins/fastclick/fastclick.js"></script>
            <script src="/public/adminlte/js/app.min.js"></script>

            <script src="/public/js/sweetalert-dev.js"></script>


            <script>
                // window._token = 'Zw1eYq4tsFJFwBA8kJfLb6fP8Lt3xu69dsUILDfj';

                var csrfToken = $('[name="csrf_token"]').attr('content');

                setInterval(refreshToken, 600000); // 1 hour 

                function refreshToken() {
                    $.get('refresh-csrf').done(function(data) {
                        csrfToken = data; // the new token
                    });
                }

                setInterval(refreshToken, 600000); // 1 hour
            </script>

            <script>
                $.extend(true, $.fn.dataTable.defaults, {
                    "language": {
                        "url": "//cdn.datatables.net/plug-ins/1.10.15/i18n/English.json"
                    }
                });
            </script>



            <script>
                $(document).ready(function() {
                    $(".notifications-menu").on('click', function() {
                        if (!$(this).hasClass('open')) {
                            $('.notifications-menu .label-warning').hide();
                            $.get('internal_notifications/read');
                        }
                    });
                });
            </script>


            <script src="/public/js/angular.js"></script>
            <script src="/public/js/angular-messages.js"></script>

            <script>
                app = angular.module('academia', ['ngMessages']);
                app.directive('stringToNumber', function() {
                    return {
                        require: 'ngModel',
                        link: function(scope, element, attrs, ngModel) {
                            ngModel.$parsers.push(function(value) {
                                return '' + value;
                            });
                            ngModel.$formatters.push(function(value) {
                                return parseFloat(value);
                            });
                        }
                    };
                });
                app.directive('input', function($parse) {
                    return {
                        restrict: 'E',
                        multiElement: true,
                        require: '?ngModel',
                        link: function(scope, element, attrs) {
                            e = element[0];

                            if (attrs.ngModel && attrs.value) {
                                $parse(attrs.ngModel).assign(scope, attrs.value);
                            }
                        }
                    };
                });

                app.directive('textarea', function($parse) {
                    return {
                        restrict: 'E',
                        multiElement: true,
                        require: '?ngModel',
                        link: function(scope, element, attrs) {
                            e = element[0];
                            // console.log(element[0].value);
                            if (attrs.ngModel && e.value) {
                                $parse(attrs.ngModel).assign(scope, e.value);
                            }
                        }
                    };
                });
                app.directive('select', function($parse) {
                    return {
                        restrict: 'E',
                        multiElement: true,
                        require: '?ngModel',
                        link: function(scope, element, attrs) {
                            e = element[0];
                            selectedValue = e.options[e.selectedIndex].value;
                            // console.log(selectedValue);
                            if (attrs.ngModel && selectedValue) {
                                $parse(attrs.ngModel).assign(scope, selectedValue);
                            }
                        }
                    };
                });

                /**
                 * PASSWORD AND CONFIRM PASSWORD FIELDS VALIDATION DIRECTIVE
                 * @return  {[type]} [description]
                 */
                var compareTo = function() {
                    return {
                        require: "ngModel",
                        scope: {
                            otherModelValue: "=compareTo"
                        },
                        link: function(scope, element, attributes, ngModel) {

                            ngModel.$validators.compareTo = function(modelValue) {
                                return modelValue == scope.otherModelValue;
                            };

                            scope.$watch("otherModelValue", function() {
                                ngModel.$validate();
                            });
                        }
                    };
                };

                app.directive("compareTo", compareTo);

                /**
                 * FILE VALIDATION DIRECTIVES BEFORE UPLOAD
                 */

                var validImage = function($rootScope) {
                    var validFormats = ['jpg', 'png', 'jpeg'];
                    return {
                        require: "ngModel",
                        scope: {
                            otherModelValue: "=validImage"
                        },
                        link: function(scope, element, attributes, ngModel) {
                            $rootScope.isImageValid = 'true';
                            // console.log(element);
                            ngModel.$validators.validImage = function(modelValue) {

                                element.on('change', function() {

                                    // e = element[0];
                                    // fileObject = $.parseJSON(e.files);
                                    // console.log(e.files);
                                    file_size = this.files[0].size;
                                    console.log(file_size);
                                    valid_size = true;

                                    var value = element.val(),
                                        ext = value.substring(value.lastIndexOf('.') + 1).toLowerCase();
                                    console.log(validFormats.indexOf(ext) !== -1);
                                    $rootScope.isImageValid = validFormats.indexOf(ext) !== -1;
                                    $rootScope.$apply();
                                    console.log(" $rootScope.isImageValid   " + $rootScope.isImageValid);
                                    if (file_size > 2000000) {

                                        return false;
                                    } else {
                                        return validFormats.indexOf(ext) !== -1;
                                    }
                                });
                            };


                        }
                    };
                };
                app.directive("validImage", validImage);
            </script>
            <link rel="stylesheet" href="/public/css/alertify/themes/alertify.core.css">
            <link rel="stylesheet" href="/public/css/alertify/themes/alertify.default.css" id="toggleCSS">

            <script src="/public/js/alertify.js"></script>
            <script src="/public/js/ngStorage.js"></script>
            <script src="/public/js/angular-messages.js"></script>


            <script>
                var app = angular.module('academia', ['ngMessages']);
            </script>

            <script>
                app.factory('httpPreConfig', function($http, $rootScope, $timeout, $q) {
                    return {
                        webServiceCallPost: function(url, data) {
                            $('#ajax_loader').fadeIn(100);
                            return $http.post(url, data).then(function(response) {
                                $('#ajax_loader').fadeOut(100);
                                return response;
                            });
                        },
                        getToken: function() {
                            return $('[name="_token"]').val();
                        },
                        findIndexInData: function(Array, property, action) {
                            var result = -1;
                            angular.forEach(Array, function(value, index) {
                                if (value[property] == action) {
                                    result = index;
                                }
                            });
                            return result;
                        },
                        showConfirmation: function() {
                            var defer = $q.defer();


                            swal({

                                    title: "Are You Sure?",

                                    type: "warning",

                                    showCancelButton: true,

                                    confirmButtonClass: "btn-danger",

                                    confirmButtonText: "Yes, Delete It!",

                                    cancelButtonText: "No, Cancel Please!",

                                    closeOnConfirm: true,

                                    closeOnCancel: false

                                },

                                function(isConfirm) {

                                    if (isConfirm) {


                                        defer.resolve(1);

                                    } else {

                                        swal("Cancelled", "Your Record Is Safe :)", "error");

                                        defer.resolve(0);
                                    }

                                });
                            return defer.promise;
                        },
                        webServiceCallPost1: function(url, data) {
                            var deferred = $q.defer();
                            return $.ajax({
                                type: "POST",
                                url: url,
                                crossDomain: true,
                                dataType: "json",
                                data: data,
                                timeout: 2000000,
                                async: true,
                                success: function(response) {
                                    console.log("response    " + JSON.stringify(response));
                                    deferred.resolve();
                                },
                                error: function(xhr, ajaxOptions, thrownError) {

                                    if (xhr.status == 0) {

                                    } else if (xhr.status == 404) {

                                    } else {

                                    }
                                },
                                beforeSend: function() {},
                                complete: function() {}
                            });

                        }
                    }

                });
            </script>

            <script>
                app.controller('prepareAuctionData', function($scope, $http, httpPreConfig) {



                    $scope.getSubCategories = function(selected_category) {


                        route = '/auctions/get-sub-categories',
                            data = {
                                _method: 'post',
                                '_token': httpPreConfig.getToken(),
                                'category_id': selected_category
                            };

                        $scope.sub_categories = [];

                        httpPreConfig.webServiceCallPost(route, data).then(function(result) {

                            $scope.sub_categories = result.data.sub_categories;

                            // $scope.branch_id      = $scope.branches[0];



                        });
                    }





                    $scope.initFunctions = function() {

                        $scope.getSubCategories(5);

                    }




                    $scope.getBidHistory = function(ab_id) {


                        route = '/auctions/bid-history',
                            data = {
                                _method: 'post',
                                '_token': httpPreConfig.getToken(),
                                'id': ab_id
                            };

                        $scope.bid_history = [];

                        httpPreConfig.webServiceCallPost(route, data).then(function(result) {

                            $scope.bid_history = result.data.records;

                            // $scope.branch_id      = $scope.branches[0];



                        });
                    }

                });
            </script>
            <script>
                var photo_counter = 0;
                Dropzone.options.realDropzone = {

                    uploadMultiple: true,
                    parallelUploads: 100,
                    maxFile: 15,
                    maxFilesize: 8,
                    previewsContainer: '#dropzonePreview',
                    previewTemplate: document.querySelector('#preview-template').innerHTML,
                    addRemoveLinks: true,
                    dictRemoveFile: 'Remove',
                    dictFileTooBig: 'File size is bigger than 8MB',
                    acceptedFiles: "application/pdf,image/*",
                    autoProcessQueue: true,

                    // The setting up of the dropzone
                    init: function() {
                        var previous_uploads = [];

                        photo_counter = previous_uploads.length;
                        for (i = 0; i < previous_uploads.length; i++) {

                            var mockFile = previous_uploads[i];

                            this.options.addedfile.call(this, mockFile);

                            dataUrl = "/public/uploads/auctions/" + mockFile.filename;

                            if (!mockFile.type.match(/image.*/)) {
                                dataUrl = "/public/images/img-example.jpg";
                            }
                            this.options.thumbnail.call(this, mockFile, dataUrl);

                            // mockFile.previewElement.classList.add('dz-success');
                            // mockFile.previewElement.classList.add('dz-complete');

                        }
                        // $('.dz-image').css('background-image', 'url(/public/uploads/auctions/)'+mockFile.filename);

                        $("#photoCounter").text("(" + photo_counter + ")");

                        this.on("removedfile", function(file) {
                            $.ajax({
                                type: 'POST',
                                url: '/auctions/delete-image/' + file.id,
                                data: {
                                    id: file.id,
                                    _token: $('[name="_token"]').val()
                                },
                                dataType: 'html',
                                success: function(data) {
                                    photo_counter--;
                                    $("#photoCounter").text("(" + photo_counter + ")");

                                }
                            });

                        });
                    },
                    error: function(file, response) {
                        if ($.type(response) === "string")
                            var message = response; //dropzone sends it's own error messages in string
                        else
                            var message = response.message;
                        file.previewElement.classList.add("dz-error");
                        _ref = file.previewElement.querySelectorAll("[data-dz-errormessage]");
                        _results = [];
                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                            node = _ref[_i];
                            _results.push(node.textContent = message);
                        }
                        return _results;
                    },
                    success: function(file, done) {

                        file.id = done[photo_counter];
                        photo_counter++;
                        $("#photoCounter").text("(" + photo_counter + ")");
                    },
                    accept: function(file, done) {

                        var thumbnail = $('.dropzone .dz-preview.dz-file-preview .dz-image:last ');


                        switch (file.type) {
                            case 'application/pdf':

                                thumbnail.css('background-image', 'url(/public/images/pdf.png)');
                                break;
                            case 'application/vnd.openxmlformats-officedocument.wordprocessingml.document':
                                thumbnail.css('background', 'url(img/doc.png)');
                                break;
                        }

                        done();
                    },
                }
            </script>

            <script src="/public/js/moment.min.js"></script>
            <script src="/public/js/bootstrap-datetimepicker.min.js"></script>

            <script>
                $(function() {
                    $('#datetimepicker6').datetimepicker();
                    $('#datetimepicker7').datetimepicker({
                        useCurrent: false //Important! See issue #1075
                    });
                    $("#datetimepicker6").on("dp.change", function(e) {
                        $('#datetimepicker7').data("DateTimePicker").minDate(e.date);
                    });
                    $("#datetimepicker7").on("dp.change", function(e) {
                        $('#datetimepicker6').data("DateTimePicker").maxDate(e.date);
                    });
                });


                $(function() {
                    $('#datetimepicker1').datetimepicker();
                });
            </script>


            <script>
                function auctionBidder(id) {
                    var id = id;
                    if (id) {
                        $("#ab_id").val(id);
                        $("#sendEmailModal").modal('show');
                    }
                }
            </script>




        </div>


       
</body>

</html>